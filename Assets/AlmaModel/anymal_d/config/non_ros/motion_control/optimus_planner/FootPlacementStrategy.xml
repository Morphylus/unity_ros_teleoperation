<?xml version="1.0" ?>
<FootPlacementStrategy RegainPositionForStride="1.3" maxFootholdDisplacementVelocity="0.005"
                       slippageRecoveryStrategy="ApproachToPreviousFootholdIteratively">
  <FootholdGenerator>

    <Optimized>
      <InequalityConstraints>
        <KinematicConstraints enable="false" max_leg_extension="0.61 " num_of_edges="16"/>
        <CollisionAvoidance enable="true" safety_margin="0.13" num_of_edges="10" closed_cone="false"/>
      </InequalityConstraints>
    </Optimized>

    <OptimizedInvPend footprint_center="torso_com" adapt_to_path_regularizer="true"> <!-- torso_com, base or whole_body_com -->
      <Gait type="walk, balance">
        <Weights invertedPendulum="1.0" previousSolution="0.1"/>
        <BaseToDefaultFoothold x="0.36" y_h="0.24" y_f="0.24" rel_vel_offset="0.0"/>
        <Gains feedbackScale="1.2" feedforwardScale="1.0"/>
      </Gait>
      <Gait type="crawl">
        <Weights invertedPendulum="1.0" previousSolution="0.1"/>
        <BaseToDefaultFoothold x="0.36" y_h="0.3" y_f="0.3" rel_vel_offset="0.0"/>
        <Gains feedbackScale="0.0" feedforwardScale="1.0"/>
      </Gait>
      <ElevationMapping search_radius="0.35">
        <Weights foothold_score="4.0" velocity_projection_="1.5" previous_solution="0.1" push_over_edge="0.48"
                 self_collision_avoidance="0.9" min_swing_distance="0.0" min_variance="10.0" motion_in_plane="0.0" step_height="0.15"
                 leg_overextension="0.6"/>
        <Inequalities max_step_height="0.3" min_dist_neightbour_leg="0.15"/>
        <PostProcessing foot_center_over_elevation_map="0.009" smooth_footholds="false"/>
      </ElevationMapping>
    </OptimizedInvPend>
  </FootholdGenerator>

  <SwingTrajectoryGenerator verbose="false"> <!-- Used with SwingTrajectoryGeneration type="kick" -->
    <Gait type="walk, balance">
      <Height initial="0.0" middle="0.13" final="-0.013"/>
      <VerticalVelocity initial="0.4" final="-0.4"/>
      <HorizontalVelocity initial="-0.4" final="0.0"/>
    </Gait>
    <Gait type="crawl">
      <Height initial="0.0" middle="0.03" final="-0.013"/>
      <VerticalVelocity initial="0.2" final="-0.2"/>
      <HorizontalVelocity initial="-0.2" final="0.0"/>
    </Gait>
  </SwingTrajectoryGenerator>

  <ContactRecovery>
    <!--
    regain_position_for_stride: Regain velocity is obtained by dividing this value with the stride duration
    p_gain:                     Pushes the regaining foot towards the nominal foothold
    d_gain:                     Pushes the regaining foot in the direction of torso velocity error
    filter_constant:            filter constant used to smooth regaining velocity
     -->
    <Regaining regain_position_for_stride="1.1" p_gain="1.5" d_gain="0.4" filter_constant="0.03"/>
    <!--
    max_sing_value:         Singularity value is 1 if leg is fully extended, 0 if end-effector touches the limb base.
                            The threshold determines the singularity value at which position feedback kicks in.
    p_gain:                 Pushes the regaining foot a direction that minimizes leg over extension.
     -->
    <SingularityAvoidance max_sing_value="0.76" p_gain="0.3"/>
  </ContactRecovery>

</FootPlacementStrategy>
